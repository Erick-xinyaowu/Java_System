<script setup lang="ts">
import { ref } from 'vue'
import { Download, Share, Refresh } from '@element-plus/icons-vue'
import { ElMessage } from 'element-plus'

const loading = ref(false)

// æ¨¡æ‹ŸæŠ¥å‘Šæ•°æ®
const report = ref({
  generatedAt: '2024-01-15',
  mbtiType: 'INTJ',
  mbtiName: 'å»ºç­‘å¸ˆå‹',
  hollandCode: 'IAR',
  overallScore: 85,
  dimensions: [
    { name: 'é€»è¾‘æ€ç»´', score: 92 },
    { name: 'åˆ›æ–°èƒ½åŠ›', score: 88 },
    { name: 'é¢†å¯¼åŠ›', score: 75 },
    { name: 'æ²Ÿé€šèƒ½åŠ›', score: 70 },
    { name: 'æ‰§è¡ŒåŠ›', score: 85 }
  ],
  recommendedCareers: [
    {
      title: 'è½¯ä»¶å·¥ç¨‹å¸ˆ',
      match: 95,
      salary: '15-35K',
      growth: 'é«˜',
      reason: 'æ‚¨çš„é€»è¾‘æ€ç»´èƒ½åŠ›å¼ºï¼Œå–œæ¬¢è§£å†³å¤æ‚é—®é¢˜ï¼Œéå¸¸é€‚åˆè½¯ä»¶å¼€å‘å·¥ä½œã€‚'
    },
    {
      title: 'æ•°æ®åˆ†æå¸ˆ',
      match: 90,
      salary: '12-30K',
      growth: 'é«˜',
      reason: 'æ‚¨å–„äºä»æ•°æ®ä¸­å‘ç°è§„å¾‹ï¼Œåˆ†æèƒ½åŠ›å‡ºè‰²ï¼Œæ•°æ®åˆ†ææ˜¯ç†æƒ³é€‰æ‹©ã€‚'
    },
    {
      title: 'äº§å“ç»ç†',
      match: 85,
      salary: '15-40K',
      growth: 'ä¸­é«˜',
      reason: 'æ‚¨å…·å¤‡æˆ˜ç•¥æ€ç»´å’Œåˆ›æ–°èƒ½åŠ›ï¼Œèƒ½å¤Ÿè§„åˆ’äº§å“å‘å±•æ–¹å‘ã€‚'
    }
  ],
  strengths: ['é€»è¾‘åˆ†æèƒ½åŠ›å¼º', 'ç‹¬ç«‹æ€è€ƒ', 'è¿½æ±‚å“è¶Š', 'å­¦ä¹ èƒ½åŠ›å¼º'],
  weaknesses: ['å¯èƒ½å¿½è§†ä»–äººæ„Ÿå—', 'æœ‰æ—¶è¿‡äºè¿½æ±‚å®Œç¾', 'å›¢é˜Ÿåä½œéœ€åŠ å¼º'],
  developmentPlan: [
    {
      phase: 'çŸ­æœŸï¼ˆ3ä¸ªæœˆï¼‰',
      goals: ['å®Œæˆç›¸å…³è¯¾ç¨‹å­¦ä¹ ', 'å‚ä¸1-2ä¸ªå®é™…é¡¹ç›®', 'æå‡ç¼–ç¨‹æŠ€èƒ½']
    },
    {
      phase: 'ä¸­æœŸï¼ˆ6-12ä¸ªæœˆï¼‰',
      goals: ['è·å¾—å®ä¹ æœºä¼š', 'å»ºç«‹ä¸“ä¸šäººè„‰', 'è€ƒå–ç›¸å…³è¯ä¹¦']
    },
    {
      phase: 'é•¿æœŸï¼ˆ1-3å¹´ï¼‰',
      goals: ['ç§¯ç´¯å·¥ä½œç»éªŒ', 'æ˜ç¡®èŒä¸šæ–¹å‘', 'æŒç»­æŠ€èƒ½æå‡']
    }
  ]
})

function handleDownload() {
  ElMessage.info('æŠ¥å‘Šä¸‹è½½åŠŸèƒ½å¼€å‘ä¸­')
}

function handleShare() {
  ElMessage.info('åˆ†äº«åŠŸèƒ½å¼€å‘ä¸­')
}

async function handleRefresh() {
  loading.value = true
  await new Promise((resolve) => setTimeout(resolve, 2000))
  loading.value = false
  ElMessage.success('æŠ¥å‘Šå·²æ›´æ–°')
}
</script>

<template>
  <div class="report-page" v-loading="loading">
    <div class="page-header">
      <div>
        <h1>èŒä¸šè§„åˆ’æŠ¥å‘Š</h1>
        <p>åŸºäºæ‚¨çš„æµ‹è¯„ç»“æœç”Ÿæˆçš„ä¸ªæ€§åŒ–èŒä¸šè§„åˆ’å»ºè®®</p>
      </div>
      <div class="header-actions">
        <el-button :icon="Refresh" @click="handleRefresh">åˆ·æ–°æŠ¥å‘Š</el-button>
        <el-button :icon="Share" @click="handleShare">åˆ†äº«</el-button>
        <el-button type="primary" :icon="Download" @click="handleDownload">
          ä¸‹è½½PDF
        </el-button>
      </div>
    </div>

    <!-- æ¦‚è§ˆå¡ç‰‡ -->
    <div class="overview-grid">
      <el-card class="overview-card primary" shadow="never">
        <div class="overview-content">
          <div class="overview-label">MBTI ç±»å‹</div>
          <div class="overview-value">{{ report.mbtiType }}</div>
          <div class="overview-sub">{{ report.mbtiName }}</div>
        </div>
      </el-card>
      <el-card class="overview-card" shadow="never">
        <div class="overview-content">
          <div class="overview-label">éœå…°å¾·ä»£ç </div>
          <div class="overview-value">{{ report.hollandCode }}</div>
          <div class="overview-sub">ç ”ç©¶å‹-è‰ºæœ¯å‹-ç°å®å‹</div>
        </div>
      </el-card>
      <el-card class="overview-card" shadow="never">
        <div class="overview-content">
          <div class="overview-label">ç»¼åˆåŒ¹é…åº¦</div>
          <div class="overview-value">{{ report.overallScore }}%</div>
          <div class="overview-sub">èŒä¸šåŒ¹é…è¯„åˆ†</div>
        </div>
      </el-card>
    </div>

    <!-- èƒ½åŠ›ç»´åº¦ -->
    <el-card class="section-card" shadow="never">
      <template #header>
        <span class="card-title">èƒ½åŠ›ç»´åº¦åˆ†æ</span>
      </template>
      <div class="dimensions-list">
        <div v-for="dim in report.dimensions" :key="dim.name" class="dimension-item">
          <div class="dimension-info">
            <span class="dimension-name">{{ dim.name }}</span>
            <span class="dimension-score">{{ dim.score }}åˆ†</span>
          </div>
          <el-progress
            :percentage="dim.score"
            :stroke-width="12"
            :show-text="false"
            :color="dim.score >= 80 ? '#4F46E5' : dim.score >= 60 ? '#059669' : '#D97706'"
          />
        </div>
      </div>
    </el-card>

    <!-- æ¨èèŒä¸š -->
    <el-card class="section-card" shadow="never">
      <template #header>
        <span class="card-title">æ¨èèŒä¸šæ–¹å‘</span>
      </template>
      <div class="careers-grid">
        <div v-for="career in report.recommendedCareers" :key="career.title" class="career-card">
          <div class="career-header">
            <h3>{{ career.title }}</h3>
            <el-tag type="success">åŒ¹é…åº¦ {{ career.match }}%</el-tag>
          </div>
          <div class="career-meta">
            <span>ğŸ’° è–ªèµ„ï¼š{{ career.salary }}</span>
            <span>ğŸ“ˆ å‘å±•ï¼š{{ career.growth }}</span>
          </div>
          <p class="career-reason">{{ career.reason }}</p>
        </div>
      </div>
    </el-card>

    <!-- ä¼˜åŠ£åŠ¿åˆ†æ -->
    <div class="two-col-grid">
      <el-card class="section-card" shadow="never">
        <template #header>
          <span class="card-title">âœ… ä¼˜åŠ¿ç‰¹ç‚¹</span>
        </template>
        <ul class="trait-list success">
          <li v-for="item in report.strengths" :key="item">{{ item }}</li>
        </ul>
      </el-card>

      <el-card class="section-card" shadow="never">
        <template #header>
          <span class="card-title">âš ï¸ æå‡ç©ºé—´</span>
        </template>
        <ul class="trait-list warning">
          <li v-for="item in report.weaknesses" :key="item">{{ item }}</li>
        </ul>
      </el-card>
    </div>

    <!-- å‘å±•è§„åˆ’ -->
    <el-card class="section-card" shadow="never">
      <template #header>
        <span class="card-title">èŒä¸šå‘å±•è§„åˆ’</span>
      </template>
      <el-timeline>
        <el-timeline-item
          v-for="plan in report.developmentPlan"
          :key="plan.phase"
          :timestamp="plan.phase"
          placement="top"
          color="#4F46E5"
        >
          <ul class="plan-goals">
            <li v-for="goal in plan.goals" :key="goal">{{ goal }}</li>
          </ul>
        </el-timeline-item>
      </el-timeline>
    </el-card>

    <!-- æŠ¥å‘Šä¿¡æ¯ -->
    <div class="report-footer">
      <p>æŠ¥å‘Šç”Ÿæˆæ—¶é—´ï¼š{{ report.generatedAt }}</p>
      <p>æœ¬æŠ¥å‘ŠåŸºäºæ‚¨çš„æµ‹è¯„æ•°æ®ç”± AI æ™ºèƒ½ç”Ÿæˆï¼Œä»…ä¾›å‚è€ƒ</p>
    </div>
  </div>
</template>

<style scoped>
.report-page {
  padding: 0;
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 32px;
  flex-wrap: wrap;
  gap: 16px;
}

.page-header h1 {
  font-size: 28px;
  font-weight: 700;
  color: #1e293b;
  margin-bottom: 8px;
}

.page-header p {
  font-size: 15px;
  color: #64748b;
}

.header-actions {
  display: flex;
  gap: 12px;
}

/* æ¦‚è§ˆå¡ç‰‡ */
.overview-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 24px;
  margin-bottom: 24px;
}

.overview-card {
  border-radius: 16px;
  border: none;
}

.overview-card.primary {
  background: linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%);
  color: #fff;
}

.overview-content {
  text-align: center;
}

.overview-label {
  font-size: 14px;
  opacity: 0.8;
  margin-bottom: 8px;
}

.overview-value {
  font-size: 36px;
  font-weight: 800;
  margin-bottom: 4px;
}

.overview-card:not(.primary) .overview-value {
  color: #4F46E5;
}

.overview-sub {
  font-size: 13px;
  opacity: 0.7;
}

/* é€šç”¨å¡ç‰‡ */
.section-card {
  border-radius: 16px;
  border: none;
  margin-bottom: 24px;
}

.card-title {
  font-size: 18px;
  font-weight: 600;
  color: #1e293b;
}

/* èƒ½åŠ›ç»´åº¦ */
.dimensions-list {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.dimension-item {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.dimension-info {
  display: flex;
  justify-content: space-between;
}

.dimension-name {
  font-weight: 500;
  color: #334155;
}

.dimension-score {
  font-weight: 600;
  color: #4F46E5;
}

/* èŒä¸šæ¨è */
.careers-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 20px;
}

.career-card {
  padding: 20px;
  background: #f8fafc;
  border-radius: 12px;
}

.career-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.career-header h3 {
  font-size: 18px;
  font-weight: 600;
  color: #1e293b;
}

.career-meta {
  display: flex;
  gap: 16px;
  font-size: 14px;
  color: #64748b;
  margin-bottom: 12px;
}

.career-reason {
  font-size: 14px;
  color: #475569;
  line-height: 1.6;
}

/* ä¸¤åˆ—å¸ƒå±€ */
.two-col-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 24px;
}

.trait-list {
  list-style: none;
  padding: 0;
}

.trait-list li {
  padding: 12px 16px;
  border-radius: 8px;
  margin-bottom: 8px;
  font-size: 15px;
}

.trait-list.success li {
  background: #ecfdf5;
  color: #047857;
}

.trait-list.warning li {
  background: #fffbeb;
  color: #b45309;
}

/* å‘å±•è§„åˆ’ */
.plan-goals {
  padding-left: 20px;
  margin: 0;
}

.plan-goals li {
  font-size: 15px;
  color: #475569;
  line-height: 2;
}

/* é¡µè„š */
.report-footer {
  text-align: center;
  padding: 32px 0;
  color: #94a3b8;
  font-size: 13px;
}

.report-footer p {
  margin-bottom: 4px;
}

@media (max-width: 768px) {
  .two-col-grid {
    grid-template-columns: 1fr;
  }
}
</style>
